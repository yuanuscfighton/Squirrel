<!DOCTYPE html>
<html lang = "en">
<head>
  <meta charset = "UTF-8">
  <!-- Create 2024/3/18 09:42 -->
  <title>è‡ªå®šä¹‰éå†æ•°æ®</title>
</head>
<body>
  <script>

    // è¿­ä»£å™¨ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦è‡ªå®šä¹‰éå†æ•°æ®çš„æ—¶å€™

    // éœ€æ±‚ï¼šéå† taskObj å¯¹è±¡ä¸­çš„ details æ•°ç»„ä¸­çš„å…ƒç´ 

    const taskObj = {
      name: 'ä»»åŠ¡1',
      details: [
        'a', 'b', 'c', 'd'
      ],

      /*
         âŒ é”™è¯¯1ï¼šResult of the Symbol.iterator method is not an objectï¼Œæ–¹æ³•æœ‰äº†ï¼Œä½†æ²¡æœ‰è¿”å›å€¼ã€‚
          å³ï¼Œå·¥ä½œåŸç†1ï¼šéœ€è¦åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰æ•°æ®ç»“æ„çš„èµ·å§‹ä½ç½®
            [Symbol.iterator]() {
                // TODO: éœ€è¦åŠ ä¸Š return {} ä»£ç 
            }
      */

      /*
       âŒ é”™è¯¯2ï¼šundefined is not a functionï¼ŒæŒ‡é’ˆå¯¹è±¡ä¸­æœ‰ä¸ª next æ–¹æ³•ï¼Œä½†ğŸ‘‡ğŸ»è¿™é‡Œæ²¡æœ‰
          å³ï¼Œå·¥ä½œåŸç†2ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨å¯¹è±¡çš„ next æ–¹æ³•ï¼ŒæŒ‡é’ˆè‡ªåŠ¨æŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬ä¸€ä¸ªæˆå‘˜
             å·¥ä½œåŸç†3ï¼šæ¥ä¸‹æ¥ä¸æ–­è°ƒç”¨ next æ–¹æ³•ï¼ŒæŒ‡é’ˆä¸€ç›´å¾€åç§»åŠ¨ï¼Œç›´åˆ°æŒ‡å‘æœ€åä¸€ä¸ªæˆå‘˜
            [Symbol.iterator]() {
                return {};
                // TODO: éœ€è¦åŠ ä¸Š next: function() { ... }
            }
       */

      /*
       âŒ é”™è¯¯3ï¼šIterator result undefined is not an objectï¼Œnextæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª undefined
          å³ï¼Œå·¥ä½œåŸç†4ï¼šæ¯è°ƒç”¨ next æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å« value å’Œ done å±æ€§çš„å¯¹è±¡
            [Symbol.iterator]() {
                return {
                    next: function() {
                        // TODO: éœ€è¦åŠ ä¸Š return { value: "xxx", done: false };
                    }
                };
            }
       */

      /*
        âŒ é”™è¯¯4ï¼šä¸€ç›´åœ¨è¾“å‡ºç»“æœï¼Œå› ä¸º done å±æ€§çš„å€¼æ˜¯ false
            [Symbol.iterator]() {
                return {
                    next: function() {
                        return {value: 'abc', done: false}; // falseè¡¨ç¤ºæ²¡æœ‰ç»“æŸ
                    }
                };
            }
       */

      [Symbol.iterator]() { // å®ç°äº†å¯¹ä¸€ä¸ª å¯¹è±¡ çš„éå†
        // ç´¢å¼•å˜é‡
        let index = 0;
        let _this = this;
        return {  // å› ä¸º this æ˜¯åœ¨ è¿™ä¸ªå¯¹è±¡ä¸­ä½¿ç”¨ï¼Œå³ { line66 ~ line77 è¿™ä¸ªå¯¹è±¡ }ï¼Œæ‰€ä»¥éœ€è¦åœ¨ line59 ä¿å­˜ä¸‹ this
          next: function () {
            // æ ¹æ® index å†³å®šè¿”å›ç»“æœ
            if (index < _this.details.length) {
              const result = {value: _this.details[index], done: false};
              index++; // ä¸‹æ ‡è‡ªå¢
              return result;
            } else {
              return {value: undefined, done: true};
            }
          }
        }
      }
    }

    // æƒ³ä½¿ç”¨ for...of éå† taskObj å¯¹è±¡ï¼Œæ¯æ¬¡è¿”å›çš„ç»“æœæ˜¯ taskObj å¯¹è±¡ä¸­çš„ details å±æ€§çš„å€¼
    for (let v of taskObj) {
      console.log(v);
    }

    // è™½ç„¶ taskObj.details ä¹Ÿå¯ä»¥ç›´æ¥éå†æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œä½†ä¸ç¬¦åˆé¢å‘å¯¹è±¡æ€æƒ³

  </script>
</body>
</html>